# OPC UA

## 起源

前文已经提到：基于 `OPC Classic` 的成功， `OPC` 基金会在 `2008` 年推出了新的技术标准 `OPC UA` （**Unified Architecture**，统一架构），将各个 `OPC Classic` 规范的所有功能集成到一个可扩展的框架中， `OPC UA` 基于 `TCP/ IP socket` 传输层，独立于平台并且面向对象，是**下一代**的 `OPC` 标准。

为什么会有下一代的标准的提出？是因为原来的 `OPC` 协议无法跟上时代发展的步伐了，技术发展上要求有更多的操作性：

1. 微软逐步淡化`COM`，而跨平台的`Web`服务和`SOA`逐步加强。
2. `OPC`的供应商希望一套担心的服务实现`OPC`数据模块（`DA`,`A&E`,`HDA`….）。
3. `OPC`供应商希望在**非微软**的平台，包括**嵌入式**设备实现`OPC`功能。
4. 一些合作组织需要一个可靠的，有效地方式实现高水平结构数据的转移。

> [!tip|label: 提示]
> `SOA` 即 `service-oriented architecture` ，中文名称为：**面向服务的体系结构**。它是一个**组件模型**，它将应用程序的不同**功能单元**（称为**服务**）通过这些服务之间定义良好的**接口**和**契约**联系起来。接口是采用**中立**的方式进行定义的，它应该独立于实现服务的硬件平台、操作系统和编程语言。这使得构建在各种这样的系统中的服务可以以一种统一和通用的方式进行交互。

## 新特点

### 统一的访问

传统 `OPC COM` 特性将不同的功能分布于多个 `COM` 服务器，通过接口连接代表不同特性的功能。 `OPC COM` 服务器提供报警但不持续连续的提供触发报警的数据的访问。例如，提供存储历史数据的 `OPC COM` 服务器不允许当前数据被读和更新。这种特性造成了集成的问题，因为单一系统的信息不能通过一致的方式访问。 `OPC UA` 解决了包含多种可用信息的通用地址通过单一服务访问的集成问题。

### 更好的认证互操作性

`OPC UA` 特性通过和已取得成功的 `OPC COM` 认证程序一样提供的服务器和客户端测试工具。这些测试工具使得供应商可以验证他们产品是否符合特性的要求，改善产品的质量。 `OPC UA` 和 `OPC COM` 特性通过认证以后，可以获得相应的认证标志，通过使用 `OPC` 认证的产品可以减少最终用户的系统集成成本。

### 设计的可靠性

`OPC UA` 是为高可用性和冗余架构而设计。完整的可配置的超时，错误检测，和恢复特性使得 `OPC UA` 产品可以无缝处理出现错误或失败的情况（例如网络通信的丢失）。标准的支持冗余功能的 `OPC UA` 模块使得从不同厂商的应用部署成为可能。

### 跨域防火墙和通过互联网

`OPC UA` 由客户端启动通信通道，这意味着不需要像 `OPC COM` 一样需要配置客户端以允许服务器的访问。 `OPC UA` 能通过标准的 `HTTP` 或 `UA TCP` 端口或任何管理员愿意开放的其他端口来进行通信。 `OPC UA` 使用基于安全的额消息，这意味着可以通过第三方的代理进行通信。

### 通过信息模型减少配置时间

`OPC UA` 架构提供基本的应用，供应商可以提供特定应用的信息模型，这将大大降低配置和维护这些模块的成本。 `OPC` 基金会正和 `MIMOSA` ， `FDI` ， `PLCopen` （ `IEC61131` ）组织协作开发 `OPC UA` 信息模型。

### 标准安全模型

在过去，安全问题时最后才考虑的，很多供应商没有测试他们产品的安全许可。这意味着对于最终用户很难配置安全性，或根本不可能。 `OPC UA` 架构通过标准的， `UA` 应用必须实施的安全模型解决了这个问题。这增强了互操作性和降低了配置和维护成本。 `OPC UA` 同时有利于适合任何平台的任何 `OPCUA` 产品的安全设置管理的标准工具的开发。

### 从嵌入式系统到企业级的单一的解决方案

轻量级的 `OPC UA` 可以作为有效的**二进制**通信协议，例如 `OPC UA` 已经移植到很多嵌入式系统包括 `VxWorks` ， `Linux` 和专有的 `RTOSs` (**Real Time Operating Systems**)。顶级的 `OPC UA` 应用支持企业级标准的 `XML` 页面服务协议。通过一个公用的架构可以降低系统集成的成本。

### 保护已有的OPC COM投资

`OPC UA COM` 的互操作组件可以使得供应商快速实现现有的 `OPC COM` 客户端和服务器应用支持 `OPC UA` 。这些组件通过增加需要的 `OPC UA` 高级特性客户化。这意味着用户可以持续利用他们的 `OPC COM` 技术的投资开发新的 `OPC UA` 应用。

### 历史事件

`OPC UA` 通过支持历史事件扩展了 `OPC COM` 历史数据访问( `HDA` )的能力。最终用户可以通过选择的 `OPC UA` 客户端获得事件信息。

### 不丢失性能的同时实现平台独立

`OPC UA` 架构设计为提供最佳性能的同时提供平台独立。这意味着开发者可以使用他们熟悉的语言和操作系统开发基于 `OPC UA` 的应用，而不只有一种通过 `http` 使用 `SOAP/XML` 的选择。对于 `Windows` 用户来说，平台独立性也十分具有价值，因为允许应用迁移到下一代的微软通信技术。这也意味着 `OPC UA` 产品的供应商在以前的通信技术过时或有类似不可配置的较长的超时时间等技术问题时可以有更多的选择。

### 高性能的通信协议

`OPC UA` 特性定义基于 `TCP` 的二进制通信协议通过最小的开销提供最快的性能。对于企业环境 `SOAP/XML` 是通信协议中通常使用的。 `OPC UA` 提供在打包到 `SOAP/XML` 兼容的消息中之前通过 `UA` 二进制编码消息，提升通常 `XML` 消息 `10` 倍以上的性能。这种架构的优点是提供使用 `SOAP/XML` 的格式，但是在发送之前降低其复杂性和 `XML` 的大小。

### Windows通信基础 （WCF）

`OPC .Net SDK` 使用 `WCF` 提供对 `XML Web` 服务的支持。这种架构意味着在企业应用中所有基于 `OPC UA .NetSDK` 应用可以继承微软的 `XMLWeb` 服务的灵活操作性。

### 通过OPC UA SDKs降低开发成本

基于 `OPC COM` 特性的开发者都知道要求创建互操作性的应用中，接口只是很小的一部分代码。基于这个原因， `OPC` 基金会提供的 `OPC UA .NET SDK` 可以为开发者提供更多的选择，只需要很少的几百行代码就可以实现兼容于 `OPC UA` 的应用。开发者还可以选择提供给 `OPC` 基金会成员的商业化的 `SDK` 。这些 `SDK` 将大大降低开发成本，供应商也将更多的精力关注在位客户提供更有价值的产品。最终用户同样可以从 `SDK` 中获益，因为采用的是公用的架构，将少了不同应用之间的互操作性问题。

### 采用方法和程序的增强特性

已经现有的 `OPC COM` 特性关注于数据或时间，但很多应用要求能减少单一数据值或事件的复杂操作。通过 `OPC UA` 方法，服务器允许客户端通过一序列参数触发复杂功能。通过触发事件汇报进程函数可以用来控制后台流程。

### 面向对象的信息模型的灵活性

`OPC UA` 采用基于面向对象的设计信息模型。服务器开发者可以利用这么模型开发可重用的组件。客户端开发者可以基于标准对象模型建立标准的组件，可以使用在不同的服务器甚至不同供应商的应用中。
