# 对象属性——Object Attribute

弱引用表的另外一种重要应用是将**属性与对象关联起来**。在各种各样的情况下，我们能需要把某些属性绑定到某个对象，例如函数名、表的默认值即数组的大小等。

当对象是一个表时，可以通过适当的唯一键把属性存储在这个表自身中（正如之前所看到的，创建唯一键的一种简单和防止出错的方法是创建一个新表并把它当做键使用）。不过，如果对象不是一个表，那么它就不能保存它自己的属性。另外，即使是表，有时我们也不想把属性保存在原始的对象中。例如，当想保持属性的私有性时，或不想让属性干扰到表的遍历时，就需要用其他办法来关联对象与属性。

当然，外部表为对象和属性的映射提供了一种理想的方法，也就是[对偶表示](../面向对象编程/对偶表示.md)，其中将对象用作键、将对象的属性用作值。由于 `Lua` 语言允许使用任意类型的对象作为键，因此，一个外部表可以保存任意类型对象的属性。此外，存储在外部表中的属性不会干扰其他对象，并且可以像表本身一样是私有的。

不过，这个看似完美的方案有一个重大缺陷：一旦我们把一个对象当做表中的一个键，那么就是引用了它。 `Lua` 语言无法回收一个正在被用作键的对象。例如，如果使用一个普通的表来映射函数和函数名，那么这些函数就永远无法被回收。当然，我们可以使用弱引用表来解决这个缺陷。只需要**将表设置为弱引用的键**即可，这样如果没有其他的引用，则不会阻止键被回收。另一方面，**这个表不能有弱引用的值**，否则，活跃对象的属性也可能被回收。
